"use strict";(self.webpackChunktcadmin_docs=self.webpackChunktcadmin_docs||[]).push([[83],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>p});var i=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,i,a=function(e,t){if(null==e)return{};var r,i,a={},n=Object.keys(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(i=0;i<n.length;i++)r=n[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=i.createContext({}),u=function(e){var t=i.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},m=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},c="mdxType",v={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var r=e.components,a=e.mdxType,n=e.originalType,l=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),c=u(r),d=a,p=c["".concat(l,".").concat(d)]||c[d]||v[d]||n;return r?i.createElement(p,s(s({ref:t},m),{},{components:r})):i.createElement(p,s({ref:t},m))}));function p(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var n=r.length,s=new Array(n);s[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[c]="string"==typeof e?e:a,s[1]=o;for(var u=2;u<n;u++)s[u]=r[u];return i.createElement.apply(null,s)}return i.createElement.apply(null,r)}d.displayName="MDXCreateElement"},5162:(e,t,r)=>{r.d(t,{Z:()=>s});var i=r(7294),a=r(6010);const n={tabItem:"tabItem_Ymn6"};function s(e){let{children:t,hidden:r,className:s}=e;return i.createElement("div",{role:"tabpanel",className:(0,a.Z)(n.tabItem,s),hidden:r},t)}},4866:(e,t,r)=>{r.d(t,{Z:()=>w});var i=r(7462),a=r(7294),n=r(6010),s=r(2466),o=r(6550),l=r(1980),u=r(7392),m=r(12);function c(e){return function(e){return a.Children.map(e,(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:r,attributes:i,default:a}}=e;return{value:t,label:r,attributes:i,default:a}}))}function v(e){const{values:t,children:r}=e;return(0,a.useMemo)((()=>{const e=t??c(r);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function d(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function p(e){let{queryString:t=!1,groupId:r}=e;const i=(0,o.k6)(),n=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,l._X)(n),(0,a.useCallback)((e=>{if(!n)return;const t=new URLSearchParams(i.location.search);t.set(n,e),i.replace({...i.location,search:t.toString()})}),[n,i])]}function g(e){const{defaultValue:t,queryString:r=!1,groupId:i}=e,n=v(e),[s,o]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!d({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const i=r.find((e=>e.default))??r[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:t,tabValues:n}))),[l,u]=p({queryString:r,groupId:i}),[c,g]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[i,n]=(0,m.Nk)(r);return[i,(0,a.useCallback)((e=>{r&&n.set(e)}),[r,n])]}({groupId:i}),h=(()=>{const e=l??c;return d({value:e,tabValues:n})?e:null})();(0,a.useLayoutEffect)((()=>{h&&o(h)}),[h]);return{selectedValue:s,selectValue:(0,a.useCallback)((e=>{if(!d({value:e,tabValues:n}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),g(e)}),[u,g,n]),tabValues:n}}var h=r(2389);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function y(e){let{className:t,block:r,selectedValue:o,selectValue:l,tabValues:u}=e;const m=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.o5)(),v=e=>{const t=e.currentTarget,r=m.indexOf(t),i=u[r].value;i!==o&&(c(t),l(i))},d=e=>{let t=null;switch(e.key){case"Enter":v(e);break;case"ArrowRight":{const r=m.indexOf(e.currentTarget)+1;t=m[r]??m[0];break}case"ArrowLeft":{const r=m.indexOf(e.currentTarget)-1;t=m[r]??m[m.length-1];break}}t?.focus()};return a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.Z)("tabs",{"tabs--block":r},t)},u.map((e=>{let{value:t,label:r,attributes:s}=e;return a.createElement("li",(0,i.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:e=>m.push(e),onKeyDown:d,onClick:v},s,{className:(0,n.Z)("tabs__item",f.tabItem,s?.className,{"tabs__item--active":o===t})}),r??t)})))}function b(e){let{lazy:t,children:r,selectedValue:i}=e;const n=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=n.find((e=>e.props.value===i));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return a.createElement("div",{className:"margin-top--md"},n.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==i}))))}function k(e){const t=g(e);return a.createElement("div",{className:(0,n.Z)("tabs-container",f.tabList)},a.createElement(y,(0,i.Z)({},e,t)),a.createElement(b,(0,i.Z)({},e,t)))}function w(e){const t=(0,h.Z)();return a.createElement(k,(0,i.Z)({key:String(t)},e))}},395:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>m,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>u,toc:()=>c});var i=r(7462),a=(r(7294),r(3905)),n=r(4866),s=r(5162);const o={sidebar_position:14,sidebar_label:"Limit Service CPU and Memory Usage"},l="Limit Service CPU and Memory Usage",u={unversionedId:"using-tcadmin/manage-game-voice-services/limit-service-cpu-memory",id:"using-tcadmin/manage-game-voice-services/limit-service-cpu-memory",title:"Limit Service CPU and Memory Usage",description:"Limiting a service's CPU usage",source:"@site/docs/using-tcadmin/manage-game-voice-services/limit-service-cpu-memory.mdx",sourceDirName:"using-tcadmin/manage-game-voice-services",slug:"/using-tcadmin/manage-game-voice-services/limit-service-cpu-memory",permalink:"/using-tcadmin/manage-game-voice-services/limit-service-cpu-memory",draft:!1,editUrl:"https://github.com/TotalControlAdmin/tcadmin-docs/blob/master/docs/using-tcadmin/manage-game-voice-services/limit-service-cpu-memory.mdx",tags:[],version:"current",lastUpdatedAt:1693210718,formattedLastUpdatedAt:"Aug 28, 2023",sidebarPosition:14,frontMatter:{sidebar_position:14,sidebar_label:"Limit Service CPU and Memory Usage"},sidebar:"tutorialSidebar",previous:{title:"Troubleshooting Game & Voice Services",permalink:"/using-tcadmin/manage-game-voice-services/troubleshooting-game-voice-services"},next:{title:"Google Drive",permalink:"/using-tcadmin/manage-game-voice-services/google-drive"}},m={},c=[{value:"Limiting a service&#39;s CPU usage",id:"limiting-a-services-cpu-usage",level:3},{value:"Limiting a service&#39;s memory and virtual memory",id:"limiting-a-services-memory-and-virtual-memory",level:3},{value:"Virtual Servers",id:"virtual-servers",level:3},{value:"Limiting a service&#39;s CPU usage",id:"limiting-a-services-cpu-usage-1",level:3},{value:"Limiting a service&#39;s memory usage",id:"limiting-a-services-memory-usage",level:3},{value:"Billing API",id:"billing-api",level:2},{value:"Scripting",id:"scripting",level:2}],v={toc:c},d="wrapper";function p(e){let{components:t,...r}=e;return(0,a.kt)(d,(0,i.Z)({},v,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"limit-service-cpu-and-memory-usage"},"Limit Service CPU and Memory Usage"),(0,a.kt)(n.Z,{mdxType:"Tabs"},(0,a.kt)(s.Z,{value:"windows",label:"Windows",mdxType:"TabItem"},(0,a.kt)("h3",{id:"limiting-a-services-cpu-usage"},"Limiting a service's CPU usage"),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"The maximum value for CPU limit is 100%. CPU limit is affected by the number of cores assigned to the service or virtual server. For example if the service has 1 core assigned and limit is set to 50% the actual limit is 50% of 1 core.")),(0,a.kt)("p",null,"To set the CPU limit go to the game server's service settings, set the value of CPU limit and save. The CPU limit is applied immediately. The service does not need to be restarted."),(0,a.kt)("h3",{id:"limiting-a-services-memory-and-virtual-memory"},"Limiting a service's memory and virtual memory"),(0,a.kt)("admonition",{title:"important notes",type:"info"},(0,a.kt)("ul",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ul"},"If you limit a service's memory it will use more virtual memory. This can increase your server's disk activity."),(0,a.kt)("li",{parentName:"ul"},"If you set the virtual memory limit too low the service might crash while starting up or it might crash later if it requires more memory than allowed."),(0,a.kt)("li",{parentName:"ul"},"If you set the virtual memory limit and the service is currently using more than allowed you will have to restart it to apply the limit."),(0,a.kt)("li",{parentName:"ul"},"Memory usage might go slightly over 100%, specially if the game server is started with a .bat because it will add memory usage from cmd.exe and from the main exe."))),(0,a.kt)("p",null,"To set the memory or virtual memory limit go to the game server's service settings, set the values and save. The memory and virtual memory limit is applied immediately. The service does not need to be restarted."),(0,a.kt)("h3",{id:"virtual-servers"},"Virtual Servers"),(0,a.kt)("admonition",{title:"important notes",type:"info"},(0,a.kt)("ul",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ul"},"When a service belongs to a virtual server the memory limit in service settings can't be set higher than the memory assigned to the virtual server."),(0,a.kt)("li",{parentName:"ul"},"A single process can't use more memory than what is assigned in the virtual server's settings even if there is no limit assigned in service settings."),(0,a.kt)("li",{parentName:"ul"},"CPU limit of a service is affected by the number of cores assigned to the service or virtual server. For example if the parent server has 16 cores, the virtual server has 4 cores and CPU limit of a service is set to 50% it will use up to 2 cores. In this case if you change the virtual server's cores the service needs to be restarted for the change to take effect.")))),(0,a.kt)(s.Z,{value:"linux",label:"Linux",mdxType:"TabItem"},(0,a.kt)("h3",{id:"limiting-a-services-cpu-usage-1"},"Limiting a service's CPU usage"),(0,a.kt)("p",null,"Each core is 100%. The maximum value is 100 multiplied by the number of cores. For example 200% means 2 full cores.\nTo set the CPU limit go to the game server's service settings, set the value of CPU limit and save. The CPU limit is applied after the service is restarted."),(0,a.kt)("h3",{id:"limiting-a-services-memory-usage"},"Limiting a service's memory usage"),(0,a.kt)("p",null,"This feature is supported starting in TCAdmin version 2.0.161 and greater."),(0,a.kt)("admonition",{type:"warning"},(0,a.kt)("p",{parentName:"admonition"},(0,a.kt)("strong",{parentName:"p"},"CentOS 7.9")," does not support setting memory/virtual memory. If the game server crashes when setting memory or virtual memory set the limit to 0.")))),(0,a.kt)("h2",{id:"billing-api"},"Billing API"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"To limit the service's CPU configure your module to send a value for game_cpu"),(0,a.kt)("li",{parentName:"ul"},"To limit the service's memory configure your module to send a value for game_memory or game_virtual_memory"),(0,a.kt)("li",{parentName:"ul"},"The billing api supports setting these values when creating a new service and when updating the settings.")),(0,a.kt)("h2",{id:"scripting"},"Scripting"),(0,a.kt)("p",null,"This script sets the memory limit to 2GB, virtual memory to 10GB and CPU limit to 75%."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"ThisService.MemoryLimitMB = 2048\nThis service.VirtualMemoryLimitMB = 10240\nThisService.CpuLimit = 75\nThisService.Save()\nThisService.Configure()\n")))}p.isMDXComponent=!0}}]);