<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-using-tcadmin/game-voice-configuration/custom-scripts" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Custom Scripts | TCAdmin Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.tcadmin.com/img/tcadmin-logo.png"><meta data-rh="true" name="twitter:image" content="https://docs.tcadmin.com/img/tcadmin-logo.png"><meta data-rh="true" property="og:url" content="https://docs.tcadmin.com/using-tcadmin/game-voice-configuration/custom-scripts"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Custom Scripts | TCAdmin Documentation"><meta data-rh="true" name="description" content="TCAdmin supports the following scripting engines:"><meta data-rh="true" property="og:description" content="TCAdmin supports the following scripting engines:"><link data-rh="true" rel="icon" href="/img/cropped-tcadmin-favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://docs.tcadmin.com/using-tcadmin/game-voice-configuration/custom-scripts"><link data-rh="true" rel="alternate" href="https://docs.tcadmin.com/using-tcadmin/game-voice-configuration/custom-scripts" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.tcadmin.com/using-tcadmin/game-voice-configuration/custom-scripts" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Using TCAdmin","item":"https://docs.tcadmin.com/category/using-tcadmin"},{"@type":"ListItem","position":2,"name":"Game/Voice Configuration","item":"https://docs.tcadmin.com/using-tcadmin/game-voice-configuration/"},{"@type":"ListItem","position":3,"name":"Custom Scripts","item":"https://docs.tcadmin.com/using-tcadmin/game-voice-configuration/custom-scripts"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="TCAdmin Documentation" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.7c2975b1.css">
<script src="/assets/js/runtime~main.1554168e.js" defer="defer"></script>
<script src="/assets/js/main.733f314b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/tcadmin-logo.png"><link rel="preload" as="image" href="/img/TCAdmin_White.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/tcadmin-logo.png" alt="TCAdmin Docs" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/TCAdmin_White.png" alt="TCAdmin Docs" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/TotalControlAdmin/tcadmin-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://discord.gg/ptN2pGf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://community.tcadmin.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Forums<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://www.tcadmin.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Main Website<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://clients.tcadmin.com/billing/clientarea.php" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Billing<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/category/using-tcadmin">Using TCAdmin</a><button aria-label="Collapse sidebar category &#x27;Using TCAdmin&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/interface-overview">Interface Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/two-step-verification">Two-Step Verification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/security-settings">Security Settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/user-management">User Management</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/using-tcadmin/server-management/">Server Management</a><button aria-label="Expand sidebar category &#x27;Server Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/virtual-servers">Virtual Servers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/mail-server-config">Mail Server Configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/using-tcadmin/game-voice-configuration/">Game/Voice Configuration</a><button aria-label="Collapse sidebar category &#x27;Game/Voice Configuration&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/game-information">Game Information</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/ip-ports">IP &amp; Ports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/files-directories">Files &amp; Directories</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/general-settings">General Settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/commandlines">Commandlines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/steam-settings">Steam Settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/punk-buster-settings">Punkbuster Settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/file-manager">File Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/text-console">Text Console</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/web-console">Web Console</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/feature-permissions">Feature Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/run-as">Run As</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/game-mail-templates">Game Mail Templates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/file-system-permissions">File System Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/query-monitoring">Query Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/variables">Variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/configuration-files">Configuration Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/using-tcadmin/game-voice-configuration/custom-scripts">Custom Scripts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/keys">Keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/mods">Mods</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/map-packs">Map Packs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-voice-configuration/updates">Updates</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/fast-downloads">Fast Downloads</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/teamspeak-server-configuration">Teamspeak Server Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/create-game-voice-ts-services">Create Game Voice &amp; Teamspeak Services</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/using-tcadmin/manage-game-voice-services/">Manage Game &amp; Voice Services</a><button aria-label="Expand sidebar category &#x27;Manage Game &amp; Voice Services&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/manage-ts-virtual-servers">Manage Teamspeak Virtual Servers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/game-tools">Game Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/service-browser">Service Browser</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/reseller-features">Reseller Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/task-scheduler">Task Scheduler</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/support-system">Support System</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/using-tcadmin/steamcmd/">SteamCmd</a><button aria-label="Expand sidebar category &#x27;SteamCmd&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/common-errors">Common Errors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/console-wrapper">Console Wrapper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/hosting-control-panel-seperatly">Hosting the control panel website separately</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/using-tcadmin/configuring-plesk-website-as-reverse-proxy">Configuring a Plesk website as a reverse proxy for the control panel</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/misc">Misc</a><button aria-label="Expand sidebar category &#x27;Misc&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/database">Database</a><button aria-label="Expand sidebar category &#x27;Database&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/customizations">Customizations</a><button aria-label="Expand sidebar category &#x27;Customizations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/billing-api">Billing API</a><button aria-label="Expand sidebar category &#x27;Billing API&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/category/faq">FAQ</a><button aria-label="Expand sidebar category &#x27;FAQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/category/using-tcadmin"><span>Using TCAdmin</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/using-tcadmin/game-voice-configuration/"><span>Game/Voice Configuration</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Custom Scripts</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Custom Scripts</h1></header>
<p>TCAdmin supports the following scripting engines:</p>
<ul>
<li><a href="https://ironpython.net/" target="_blank" rel="noopener noreferrer">Iron Python</a></li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/csharp/" target="_blank" rel="noopener noreferrer">C#</a></li>
<li><a href="https://learn.microsoft.com/en-us/powershell/" target="_blank" rel="noopener noreferrer">Powershell</a></li>
<li><a href="https://www.javascript.com/" target="_blank" rel="noopener noreferrer">Javascript</a></li>
<li><a href="https://www.lua.org/" target="_blank" rel="noopener noreferrer">Lua</a></li>
</ul>
<p>Access object properties and method according to each language&#x27;s syntax.</p>
<p><a href="http://technet.microsoft.com/en-us/library/bb490869.aspx" target="_blank" rel="noopener noreferrer">Batch</a>/<a href="https://www.tutorialspoint.com/unix/shell_scripting.htm" target="_blank" rel="noopener noreferrer">Shell</a> script Object properties and variables are converted to environment variables.</p>
<p>You can specify if you want to run your script on Windows servers, Linux servers, or both.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="script-events">Script Events<a href="#script-events" class="hash-link" aria-label="Direct link to Script Events" title="Direct link to Script Events">​</a></h2>
<p>The following events are supported:</p>
<ul>
<li>
<p><code>Before created</code></p>
<ul>
<li>Occurs before any files and folders have been created.</li>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>After created</code></p>
<ul>
<li>Occurs after the service files have been created but before it has been configured as a service. The script is executed in the service&#x27;s root directory.</li>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>Before deleted</code></p>
<ul>
<li>Occurs before the delete process is started. The script is executed in the service&#x27;s root directory.</li>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>After deleted</code></p>
<ul>
<li>Occurs after the service files have been deleted and it has been removed from the database.</li>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>Before reinstall</code></p>
<ul>
<li>Occurs before the service files have been deleted. The script is executed in the service&#x27;s root directory.</li>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
<li><a href="/customizations/scripts/script-objects/game-switcher-scripting-variables">Game Switcher Scripting Variables</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>After reinstall</code></p>
<ul>
<li>Occurs after the service has been reinstalled but before it has been configured as a service. The script is executed in the service&#x27;s root directory.</li>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
<li><a href="/customizations/scripts/script-objects/game-switcher-scripting-variables">Game Switcher Scripting Variables</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>Before move</code></p>
<ul>
<li>Occurs before the service has been moved. It is executed on the server where the service is currently located. The script is executed in the service&#x27;s root directory.</li>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>After move</code></p>
<ul>
<li>Occurs after the service has been moved. It is executed on the server where the service was moved to. The script is executed in the service&#x27;s root directory.</li>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The <code>Custom icon</code> &amp; <code>Custom action</code> script events can also be configured as a scheduled task. This requires the <code>Scheduled Script</code> feature permission in the game&#x27;s settings. The script is executed in the service&#x27;s root directory.</p></div></div>
<ul>
<li>
<p><code>Custom icon</code> - Allows the user to execute the script by clicking on an icon in the service&#x27;s home page</p>
<ul>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
<li>The variables <code>ExecUser</code> and <code>ExecUserId</code> can be used to know the user id that executed the script.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>Custom action</code> - Allows the user to execute the script by clicking on the link in the service&#x27;s Actions tab</p>
<ul>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
<li>The variables <code>ExecUser</code> and <code>ExecUserId</code> can be used to know the user id that executed the script.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>Query monitoring</code> - Occurs after the service has been queried by the game monitor. If there is an error and <code>Ignore execution errors</code> is unchecked it will cancel all other query monitoring checks.</p>
<ul>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/this-server">ThisServer</a></li>
<li><a href="/customizations/scripts/script-objects/this-game">ThisGame</a></li>
<li><a href="/customizations/scripts/script-objects/this-user">ThisUser</a></li>
<li><a href="/customizations/scripts/script-objects/this-service">ThisService</a></li>
<li><a href="/customizations/scripts/script-objects/query-results">QueryResults</a></li>
<li>StatusInfo_CpuLastSecond</li>
<li>StatusInfo_MemoryLastSecond</li>
<li>Scripts can also be configured for each detection type in the game&#x27;s query monitoring configuration. Each detection type has additional variables that are available:<!-- -->
<ul>
<li><code>Query Failure</code>: <code>ThisService_TimesNotResponding</code></li>
<li><code>Slot Detection</code>: <code>ThisService_MaxSlotsAllowed</code>, <code>ThisService_SlotsDetected</code></li>
<li><code>Brand Detection</code>: <code>ThisService_UnbrandedHostname</code></li>
<li><code>Rule Detection</code>: <code>Rule</code>, <code>RuleVariable</code>, <code>RuleOperator</code>, <code>RuleValue</code>, <code>DetectedValue</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>Before started</code> <strong>(executed by the Service Manager)</strong> - Occurs before the service is started. The script is executed in the service&#x27;s working directory. After creating or updating a script with this event go to the game&#x27;s settings and click on Update Existing Services or go to a game server&#x27;s service settings and click on Save.</p>
<ul>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/service-manager-scripting-variables">Service Manager Scripting Variables</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>After started</code> <strong>(executed by the Service Manager)</strong> - Occurs after the service is started. The script is executed in the service&#x27;s working directory. After creating or updating a script with this event go to the game&#x27;s settings and click on Update Existing Services or go to a game server&#x27;s service settings and click on Save.</p>
<ul>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/service-manager-scripting-variables">Service Manager Scripting Variables</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>Before stopped</code> <strong>(executed by the Service Manager)</strong> - Occurs before the service is stopped. The script is executed in the service&#x27;s working directory. After creating or updating a script with this event go to the game&#x27;s settings and click on Update Existing Services or go to a game server&#x27;s service settings and click on Save.</p>
<ul>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/service-manager-scripting-variables">Service Manager Scripting Variables</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>After stopped</code> <strong>(executed by the Service Manager)</strong> - Occurs after the service is stopped. The script is executed in the service&#x27;s working directory. After creating or updating a script with this event go to the game&#x27;s settings and click on Update Existing Services or go to a game server&#x27;s service settings and click on Save.</p>
<ul>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/service-manager-scripting-variables">Service Manager Scripting Variables</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>After process crashed</code> <strong>(executed by the Service Manager)</strong> - Occurs after the service&#x27;s process has crashed. The script is executed in the service&#x27;s working directory. After creating or updating a script with this event go to the game&#x27;s settings and click on Update Existing Services or go to a game server&#x27;s service settings and click on Save.</p>
<ul>
<li><code>Available objects</code>:<!-- -->
<ul>
<li><a href="/customizations/scripts/script-objects/service-manager-scripting-variables">Service Manager Scripting Variables</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>External Download Script</code> - This script is executed when a game server has <code>Enable external download</code> checked and the local game files don&#x27;t exist.</p>
<ul>
<li>Available variables:<!-- -->
<ul>
<li><code>FilesFolderName</code></li>
<li><code>FilesFolderFullName </code></li>
<li><code>GameFilesPath </code></li>
<li><code>DownloadedFile </code></li>
<li><code>DownloadedFileWithoutExtension</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>Global Recurring Task</code> - This script will available in <code>System</code> (on the left-hand navigation) &gt; <code>Settings</code> &gt; <code>Recurring tasks</code> when you select the action <code>Execute a script</code>.</p>
<ul>
<li>Available variables:<!-- -->
<ul>
<li>All global variables with <code>Script parameter</code> checked that are used by the script. You will be asked for the value when configuring the recurring task.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-scripts">Troubleshooting Scripts<a href="#troubleshooting-scripts" class="hash-link" aria-label="Direct link to Troubleshooting Scripts" title="Direct link to Troubleshooting Scripts">​</a></h2>
<ul>
<li>Enable <a href="/misc/debug-mode">debug mode</a> on the server.</li>
<li><a href="/getting-started/server-components#startstop-in-service-mode">Stop</a> the Monitor or Service Manager service depending on the script&#x27;s event.</li>
<li><a href="/getting-started/server-components#startstop-in-service-mode">Start</a> the Monitor or Service Manager console depending on the script&#x27;s event.</li>
<li>When the script is executed the console will show the output of the batch/shell script or any iron python error.</li>
<li>On Linux if the script executes without printing any output make sure you have specified the shell interpreter at the top of the script. For example: #!/bin/bash</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-errors-and-how-to-fix-them">Common Errors and How to Fix Them<a href="#common-errors-and-how-to-fix-them" class="hash-link" aria-label="Direct link to Common Errors and How to Fix Them" title="Direct link to Common Errors and How to Fix Them">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prevent-scripts-from-hanging">Prevent scripts from hanging<a href="#prevent-scripts-from-hanging" class="hash-link" aria-label="Direct link to Prevent scripts from hanging" title="Direct link to Prevent scripts from hanging">​</a></h3>
<p>TCAdmin will wait forever until the script completes. To prevent TCAdmin from hanging you need to make sure the commands that you execute never ask for any input from the user. Most commands have a <code>quiet</code> mode that disables the user prompts.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>examples</div><div class="admonitionContent_BuS1"><ul>
<li>rd (Windows) has a /q command line switch to prevent asking to confirm if you want to delete the directory.</li>
<li>rm (Linux) has a -f command to force the command to execute without any prompts.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="script-causes-ftp-to-fail-after-restarting-the-monitor">Script causes FTP to fail after restarting the monitor<a href="#script-causes-ftp-to-fail-after-restarting-the-monitor" class="hash-link" aria-label="Direct link to Script causes FTP to fail after restarting the monitor" title="Direct link to Script causes FTP to fail after restarting the monitor">​</a></h3>
<p>If your script starts a process that will be left running in the background it is recommended to start the process like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;%TCAdminFolder%\Monitor\Tools\StartProcess.bat&quot; -exec c:\myscripts\myexe.exe -workdir c:\myscripts</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Doing it any other way may prevent the FTP server to start correctly if the monitor is restarted.</p></div></div>
<p>If you must execute the script as TCAGame copy <code>StartProcess.bat</code> to the game server&#x27;s folder or any other folder that TCAGame can access.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hide-the-commands-being-executed-in-a-window-batch-script">Hide the commands being executed in a Window batch script<a href="#hide-the-commands-being-executed-in-a-window-batch-script" class="hash-link" aria-label="Direct link to Hide the commands being executed in a Window batch script" title="Direct link to Hide the commands being executed in a Window batch script">​</a></h3>
<p>Add <code>@echo off</code> to the start of your script.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@echo off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo You should not see the actual command that is being executed.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-tcadmin-installation-folder">Get the TCAdmin installation folder<a href="#get-the-tcadmin-installation-folder" class="hash-link" aria-label="Direct link to Get the TCAdmin installation folder" title="Direct link to Get the TCAdmin installation folder">​</a></h3>
<p>You can use the <code>TCAdminFolder</code> variable.</p>
<ul>
<li>Windows batch script: <code>%TCAdminFolder%</code></li>
<li>Linux shell script: <code>${TCAdminFolder}</code></li>
<li>Iron Python: <code>TCAdminFolder</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="capture-values-before-executing-the-script">Capture values before executing the script<a href="#capture-values-before-executing-the-script" class="hash-link" aria-label="Direct link to Capture values before executing the script" title="Direct link to Capture values before executing the script">​</a></h3>
<ol>
<li>Create the variables in the game&#x27;s custom variables page. In the variable&#x27;s Options tab check <code>Script parameter</code>. If you want TCAdmin to save the value entered by the user check <code>Save script parameter value</code>.</li>
<li>Create a script for the Custom Icon or Custom Action event.</li>
<li>Use the variable in your script and check <code>Prompt for variable values</code>. TCAdmin will only as for the values of the variables used in the script.</li>
<li>Select the game server. Click on the custom icon or action. It will ask for the variable values.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secure-your-script">Secure your script<a href="#secure-your-script" class="hash-link" aria-label="Direct link to Secure your script" title="Direct link to Secure your script">​</a></h3>
<p>An invalid value could cause your script to behave in a way that was not intended.</p>
<ul>
<li>Make sure you validate the user&#x27;s input using the validation options provided by TCAdmin and from your script. You can use the regular expression field to enter an advanced validation. If you don&#x27;t know how to create regular expressions you can usually find what you want by searching on any search engine. <a href="http://regexlib.com/Search.aspx" target="_blank" rel="noopener noreferrer">regexlib.com</a> has a large collection of regular expressions: <a href="http://regexlib.com/Search.aspx" target="_blank" rel="noopener noreferrer">http://regexlib.com/Search.aspx</a></li>
<li>Use numeric textbox, checkbox and combobox instead of textbox whenever possible.<!-- -->
<ul>
<li>A numeric textbox makes sure that the user enters a numeric value.</li>
<li>A checkbox allows you to ask for simple yes/no 1/0 values.</li>
<li>A combobox makes the user select from a predefined list of values. If the value sent is not in the list it will be rejected.</li>
</ul>
</li>
<li>Make sure the variable does not contain back quotes <code>command here</code> or any other method of executing a string.</li>
<li>Check Execute as the service&#x27;s user in the script&#x27;s settings. Even if your script has a vulnerability the damage that can be done will be limited to the guest user&#x27;s permissions.<!-- -->
<ul>
<li>Note: In some cases it is not possible to run the script as the user that runs the service. For example if you have the game configured to create a user for each service this user does not exist yet when the <code>before created</code> scripts are executed.</li>
<li>You can confirm the user that is executing a script with the follow commands<!-- -->
<ul>
<li>Windows: <code>echo %USERNAME%</code></li>
<li>Linux: <code>whoami</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>example</div><div class="admonitionContent_BuS1"><p>You create a backup script for Minecraft. You want your user to enter the name of their world folder. You create a texbox for this.</p></div></div>
<p>If you don&#x27;t validate the input the user could enter <code>..</code> This will make your script create a backup of the game server root&#x27;s parent folder. It could create a backup of all services.</p>
<p>In this case the recommended way to capture a folder name is by using a combobox with <code>Source=File</code> System and <code>FilterType=Directories</code>. This way the user will be shown a list of folders in their game server&#x27;s root folder. Any value that is not in the list is automatically detected as invalid.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ironpython-how-to">IronPython how To<a href="#ironpython-how-to" class="hash-link" aria-label="Direct link to IronPython how To" title="Direct link to IronPython how To">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="print-messages-from-an-iron-python-script">Print messages from an Iron Python script<a href="#print-messages-from-an-iron-python-script" class="hash-link" aria-label="Direct link to Print messages from an Iron Python script" title="Direct link to Print messages from an Iron Python script">​</a></h3>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Use the Script.WriteToConsole function</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hello World&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">To update the message shown in the task popup window use:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ThisTaskStep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteLog</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hello World&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="throw-an-exception-from-an-iron-python-script">Throw an exception from an Iron Python script<a href="#throw-an-exception-from-an-iron-python-script" class="hash-link" aria-label="Direct link to Throw an exception from an Iron Python script" title="Direct link to Throw an exception from an Iron Python script">​</a></h3>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> clr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> System </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Exception</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">raise</span><span class="token plain"> Exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;CUSTOM ERROR MESSAGE HERE&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exit-from-an-iron-python-script">Exit from an Iron Python script<a href="#exit-from-an-iron-python-script" class="hash-link" aria-label="Direct link to Exit from an Iron Python script" title="Direct link to Exit from an Iron Python script">​</a></h3>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Use the Script.Exit function:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="import-a-py">Import a .py<a href="#import-a-py" class="hash-link" aria-label="Direct link to Import a .py" title="Direct link to Import a .py">​</a></h3>
<p>Place your custom <code>.py</code> scripts in <code>C:\Program Files\TCAdmin2\Monitor\Shared\Lib</code> or <code>/home/tcadmin/Monitor/Shared/Lib</code>. <code>Python 2.7</code> is supported.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-a-module-that-is-not-included-in-iron-python">Use a module that is not included in Iron Python<a href="#use-a-module-that-is-not-included-in-iron-python" class="hash-link" aria-label="Direct link to Use a module that is not included in Iron Python" title="Direct link to Use a module that is not included in Iron Python">​</a></h3>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Install Python 2.7 and add the Lib to the search path. Not all modules are supported.</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sys</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;C:\\Python27\\Lib&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Current process id is &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getpid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-iron-python-scripting-in-a-config-file">Use Iron Python scripting in a config file<a href="#use-iron-python-scripting-in-a-config-file" class="hash-link" aria-label="Direct link to Use Iron Python scripting in a config file" title="Direct link to Use Iron Python scripting in a config file">​</a></h3>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">You can use the following syntax:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">$ipy</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">%=</span><span class="token plain">ThisService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RootDirectory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\\&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\\\\&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">$ipy</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ReturnValue</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;xyz&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token operator" style="color:#393A34">&gt;</span></span><br></span></code></pre></div></div>
<p>If you need the code to execute when the user saves the file using the config editor you need to have <code>Read variable values from file</code> unchecked.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="demo-scripts-for-the-execute-script-in-popup-window-feature">Demo scripts for the &quot;Execute script in popup window&quot; feature<a href="#demo-scripts-for-the-execute-script-in-popup-window-feature" class="hash-link" aria-label="Direct link to Demo scripts for the &quot;Execute script in popup window&quot; feature" title="Direct link to Demo scripts for the &quot;Execute script in popup window&quot; feature">​</a></h3>
<p><strong>This feature is only available for MVC</strong>. These are Iron Python scripts but the same can be done with batch/shell scripts. Make sure you have <code>Ignore execution errors</code> unchecked.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>This feature is not compatible with <code>Enable dynamic content compression</code> in IIS</p></div></div>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Success Script</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> clr</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Threading </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Thread</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Downloading files...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Extracting...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Writing configuration files...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;&lt;span style=&quot;color:orange&quot;&gt;This is a warning message! Please wait...&lt;/span&gt;&#x27;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Deleting temporary files...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&lt;span style=&quot;color:green&quot;&gt;I\&#x27;m done. Thanks for waiting!&lt;/span&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span></code></pre></div></div>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Failure Script</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> clr</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Threading </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Thread</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> System </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Exception</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Downloading files...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Extracting...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Writing configuration files...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;&lt;span style=&quot;color:orange&quot;&gt;This is a warning message! Please wait...&lt;/span&gt;&#x27;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Deleting temporary files...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Thread</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">raise</span><span class="token plain"> Exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;An error occurred. Please &lt;a href=&#x27;https://yoursupportwebsite&#x27;&gt;contact support.&lt;/a&gt;&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="execute-a-script-from-another-script">Execute a script from another script<a href="#execute-a-script-from-another-script" class="hash-link" aria-label="Direct link to Execute a script from another script" title="Direct link to Execute a script from another script">​</a></h3>
<p>This feature requires <code>2.0.159.6</code> and greater. Use the following method. To execute a global script send a value of <code>0</code> for GameId:</p>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GameId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ScriptId</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-custom-variables-from-ironpython">Access Custom Variables from IronPython<a href="#access-custom-variables-from-ironpython" class="hash-link" aria-label="Direct link to Access Custom Variables from IronPython" title="Direct link to Access Custom Variables from IronPython">​</a></h3>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">To get the value use:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">abc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ThisService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Variables</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;VariableName&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">To set a value use:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ThisService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Variables</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;VariableName&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;value&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="capture-output-from-a-console-program">Capture output from a console program<a href="#capture-output-from-a-console-program" class="hash-link" aria-label="Direct link to Capture output from a console program" title="Direct link to Capture output from a console program">​</a></h3>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm" style="counter-reset:line-count 0"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> subprocess</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> subprocess</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">check_output</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\&quot;C:\\Program Files\\TCAdmin2\\Monitor\\Tools\\SteamCmd\\steamcmd.exe\&quot; +exit&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#Gets output from cmd</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"></span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">hasattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;returncode&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">      Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">returncode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#Gets return code from cmd</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">      Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#Gets error output from cmd</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">      Script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteToConsole</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#Other errors</span></span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="powershell-how-to">Powershell How To<a href="#powershell-how-to" class="hash-link" aria-label="Direct link to Powershell How To" title="Direct link to Powershell How To">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-output-similar-to-what-you-see-with-powershellexe">Get output similar to what you see with Powershell.exe<a href="#get-output-similar-to-what-you-see-with-powershellexe" class="hash-link" aria-label="Direct link to Get output similar to what you see with Powershell.exe" title="Direct link to Get output similar to what you see with Powershell.exe">​</a></h3>
<p>To get the same output your would get from Powershell.exe add |Out-String to the command. For example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dir|Out-String</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="print-messages-from-a-powershell-script">Print messages from a Powershell script<a href="#print-messages-from-a-powershell-script" class="hash-link" aria-label="Direct link to Print messages from a Powershell script" title="Direct link to Print messages from a Powershell script">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Use Write-Host or Write-Output</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Write-Host &quot;Hello World&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="show-output-from-command-in-real-time">Show output from command in real time<a href="#show-output-from-command-in-real-time" class="hash-link" aria-label="Direct link to Show output from command in real time" title="Direct link to Show output from command in real time">​</a></h3>
<p>By default the script will print the output of a command until the command has finished executing. Use this syntax to write each line as it becomes available.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp; &lt;command or executable&gt; &lt;arguments&gt;|%{Write-Host $_}</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">Example:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp; ping 127.0.0.1|%{Write-Host $_}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-custom-variables-from-powershell">Access Custom Variables from Powershell<a href="#access-custom-variables-from-powershell" class="hash-link" aria-label="Direct link to Access Custom Variables from Powershell" title="Direct link to Access Custom Variables from Powershell">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">To get the value use:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ThisService.Variables.GetValue(&quot;VariableName&quot;)</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">alternative you can use:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ThisService.Variables.Values[&quot;VariableName&quot;]</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">To set a value use:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ThisService.Variables[&quot;VariableName&quot;] = &quot;value</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="batchshell-how-to">Batch/Shell How To<a href="#batchshell-how-to" class="hash-link" aria-label="Direct link to Batch/Shell How To" title="Direct link to Batch/Shell How To">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-variable-value-on-linux">Get variable value on Linux<a href="#get-variable-value-on-linux" class="hash-link" aria-label="Direct link to Get variable value on Linux" title="Direct link to Get variable value on Linux">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">On Linux use environment variables like this:</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">${ThisService_VariableName}</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">On Windows use environment variables like this</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">%ThisService_ServiceId%</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/TotalControlAdmin/tcadmin-docs/blob/master/docs/using-tcadmin/game-voice-configuration/custom-scripts.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-07-03T09:45:47.000Z" itemprop="dateModified">Jul 3, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/using-tcadmin/game-voice-configuration/configuration-files"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Configuration Files</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/using-tcadmin/game-voice-configuration/keys"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Keys</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#script-events" class="table-of-contents__link toc-highlight">Script Events</a></li><li><a href="#troubleshooting-scripts" class="table-of-contents__link toc-highlight">Troubleshooting Scripts</a></li><li><a href="#common-errors-and-how-to-fix-them" class="table-of-contents__link toc-highlight">Common Errors and How to Fix Them</a><ul><li><a href="#prevent-scripts-from-hanging" class="table-of-contents__link toc-highlight">Prevent scripts from hanging</a></li><li><a href="#script-causes-ftp-to-fail-after-restarting-the-monitor" class="table-of-contents__link toc-highlight">Script causes FTP to fail after restarting the monitor</a></li><li><a href="#hide-the-commands-being-executed-in-a-window-batch-script" class="table-of-contents__link toc-highlight">Hide the commands being executed in a Window batch script</a></li><li><a href="#get-the-tcadmin-installation-folder" class="table-of-contents__link toc-highlight">Get the TCAdmin installation folder</a></li><li><a href="#capture-values-before-executing-the-script" class="table-of-contents__link toc-highlight">Capture values before executing the script</a></li><li><a href="#secure-your-script" class="table-of-contents__link toc-highlight">Secure your script</a></li></ul></li><li><a href="#ironpython-how-to" class="table-of-contents__link toc-highlight">IronPython how To</a><ul><li><a href="#print-messages-from-an-iron-python-script" class="table-of-contents__link toc-highlight">Print messages from an Iron Python script</a></li><li><a href="#throw-an-exception-from-an-iron-python-script" class="table-of-contents__link toc-highlight">Throw an exception from an Iron Python script</a></li><li><a href="#exit-from-an-iron-python-script" class="table-of-contents__link toc-highlight">Exit from an Iron Python script</a></li><li><a href="#import-a-py" class="table-of-contents__link toc-highlight">Import a .py</a></li><li><a href="#use-a-module-that-is-not-included-in-iron-python" class="table-of-contents__link toc-highlight">Use a module that is not included in Iron Python</a></li><li><a href="#use-iron-python-scripting-in-a-config-file" class="table-of-contents__link toc-highlight">Use Iron Python scripting in a config file</a></li><li><a href="#demo-scripts-for-the-execute-script-in-popup-window-feature" class="table-of-contents__link toc-highlight">Demo scripts for the &quot;Execute script in popup window&quot; feature</a></li><li><a href="#execute-a-script-from-another-script" class="table-of-contents__link toc-highlight">Execute a script from another script</a></li><li><a href="#access-custom-variables-from-ironpython" class="table-of-contents__link toc-highlight">Access Custom Variables from IronPython</a></li><li><a href="#capture-output-from-a-console-program" class="table-of-contents__link toc-highlight">Capture output from a console program</a></li></ul></li><li><a href="#powershell-how-to" class="table-of-contents__link toc-highlight">Powershell How To</a><ul><li><a href="#get-output-similar-to-what-you-see-with-powershellexe" class="table-of-contents__link toc-highlight">Get output similar to what you see with Powershell.exe</a></li><li><a href="#print-messages-from-a-powershell-script" class="table-of-contents__link toc-highlight">Print messages from a Powershell script</a></li><li><a href="#show-output-from-command-in-real-time" class="table-of-contents__link toc-highlight">Show output from command in real time</a></li><li><a href="#access-custom-variables-from-powershell" class="table-of-contents__link toc-highlight">Access Custom Variables from Powershell</a></li></ul></li><li><a href="#batchshell-how-to" class="table-of-contents__link toc-highlight">Batch/Shell How To</a><ul><li><a href="#get-variable-value-on-linux" class="table-of-contents__link toc-highlight">Get variable value on Linux</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TCAdmin. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>